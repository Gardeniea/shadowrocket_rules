[General]
ipv6 = false
bypass-system = true
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,*.lan,*.internal,fe80::/10,fc00::/7
bypass-tun = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.168.0.0/16,198.18.0.0/15,::1/128,::ffff:0:0/96,fc00::/7,fe80::/10
dns-server = https://dns.alidns.com/dns-query,https://doh.pub/dns-query
update-url = https://raw.githubusercontent.com/Johnshall/Shadowrocket-ADBlock-Rules-Forever/release/sr_top500_whitelist.conf

[Rule]

# ===== 1. 国内 & 本地，永远直连 =====
GEOIP,CN,DIRECT
DOMAIN-SUFFIX,cn,DIRECT
IP-CIDR,192.168.0.0/16,DIRECT
IP-CIDR,10.0.0.0/8,DIRECT
IP-CIDR,172.16.0.0/12,DIRECT
IP-CIDR,127.0.0.0/8,DIRECT
IP-CIDR,::1/128,DIRECT
IP-CIDR,FC00::/7,DIRECT
IP-CIDR,FE80::/10,DIRECT

# ===== 2. Apple（国行体验，全直连） =====
DOMAIN-SUFFIX,apple.com,DIRECT
DOMAIN-SUFFIX,icloud.com,DIRECT
DOMAIN-SUFFIX,mzstatic.com,DIRECT
DOMAIN-SUFFIX,cdn-apple.com,DIRECT
DOMAIN-SUFFIX,aaplimg.com,DIRECT
DOMAIN-SUFFIX,icloud-content.com,DIRECT
DOMAIN-SUFFIX,mesu.apple.com,DIRECT
DOMAIN-SUFFIX,ocsp.apple.com,DIRECT
DOMAIN-SUFFIX,swscan.apple.com,DIRECT
DOMAIN-SUFFIX,itunes.apple.com,DIRECT
DOMAIN-SUFFIX,apps.apple.com,DIRECT
DOMAIN-SUFFIX,apps.mzstatic.com,DIRECT
DOMAIN-SUFFIX,phobos.apple.com,DIRECT
DOMAIN-SUFFIX,init-p01md.push.apple.com,DIRECT
DOMAIN-SUFFIX,init-p01st.push.apple.com,DIRECT
DOMAIN-SUFFIX,init-s01st.push.apple.com,DIRECT

# ===== 3. 国内可直连 CDN（省电关键） =====
DOMAIN-SUFFIX,gstatic.com,DIRECT
DOMAIN-SUFFIX,ggpht.com,DIRECT
DOMAIN-SUFFIX,googlevideo.com,DIRECT
DOMAIN-SUFFIX,ytimg.com,DIRECT

# ===== 4. 游戏直连 =====
DOMAIN-SUFFIX,thatgamecompany.com,DIRECT
DOMAIN-SUFFIX,skyprod.com,DIRECT

# ===== 5. 必须代理的国外服务 =====
DOMAIN-SUFFIX,tiktok.com,PROXY
DOMAIN-SUFFIX,instagram.com,PROXY
DOMAIN-SUFFIX,whatsapp.com,PROXY
DOMAIN-SUFFIX,openai.com,PROXY
DOMAIN-SUFFIX,chat.openai.com,PROXY

# Google 办公（明确代理）
DOMAIN-SUFFIX,googleapis.com,PROXY
DOMAIN-SUFFIX,googleusercontent.com,PROXY
DOMAIN-SUFFIX,docs.google.com,PROXY
DOMAIN-SUFFIX,drive.google.com,PROXY
DOMAIN-SUFFIX,gmail.com,PROXY
DOMAIN-SUFFIX,meet.google.com,PROXY

# ===== 6. 兜底 =====
FINAL,PROXY

[URL Rewrite]
^https?://(www.)?(g|google)\.cn https://www.google.com 302

[MITM]
hostname = *.google.cn,*.googlevideo.com
